(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[189],{2833:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/dashboard",function(){return a(3272)}])},3272:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var r=a(5893),s=a(7294),l=a(9880),i=a(3223),d=a(9008),n=a.n(d),c=a(2851),o=a(5068),x=a(4206),m=a(2154),h=a(4283),b=a(9033),u=a(2190);function g(){let[e,t]=(0,s.useState)(null),[a,i]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{l.O.auth.getSession().then(({data:{session:e}})=>{t(e),i(!1)});let{data:{subscription:e}}=l.O.auth.onAuthStateChange((e,a)=>{t(a)});return()=>e.unsubscribe()},[]),a)?(0,r.jsx)("div",{className:"p-8 text-center",children:"Loading..."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n(),{children:[(0,r.jsx)("title",{children:"Admin Dashboard"}),(0,r.jsx)("meta",{name:"robots",content:"noindex, nofollow"})]}),e?(0,r.jsx)(z,{session:e}):(0,r.jsx)(j,{})]})}function j(){let[e,t]=(0,s.useState)(""),[a,d]=(0,s.useState)(""),[n,c]=(0,s.useState)(!1),[o,x]=(0,s.useState)(null),m=async t=>{t.preventDefault(),c(!0),x(null);let{error:r}=await l.O.auth.signInWithPassword({email:e,password:a});r&&x(r.message),c(!1)};return(0,r.jsx)(i.W2,{className:"mt-16 sm:mt-32",children:(0,r.jsxs)("div",{className:"mx-auto max-w-sm rounded-lg border border-zinc-200 bg-white p-6 shadow-md dark:border-zinc-700 dark:bg-zinc-800",children:[(0,r.jsx)("h1",{className:"mb-6 text-2xl font-bold text-zinc-900 dark:text-zinc-100",children:"Admin Login"}),(0,r.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300",children:"Email"}),(0,r.jsx)("input",{type:"email",value:e,onChange:e=>t(e.target.value),className:"mt-1 block w-full rounded-md border-zinc-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 dark:border-zinc-600 dark:bg-zinc-700 dark:text-white",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300",children:"Password"}),(0,r.jsx)("input",{type:"password",value:a,onChange:e=>d(e.target.value),className:"mt-1 block w-full rounded-md border-zinc-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 dark:border-zinc-600 dark:bg-zinc-700 dark:text-white",required:!0})]}),o&&(0,r.jsx)("p",{className:"text-sm text-red-600",children:o}),(0,r.jsx)("button",{type:"submit",disabled:n,className:"w-full rounded-md bg-teal-500 px-4 py-2 text-white hover:bg-teal-600 disabled:opacity-50",children:n?"Logging in...":"Login"})]})]})})}function z(){let[e,t]=(0,s.useState)(new Date().getFullYear()),[a,d]=(0,s.useState)(new Date().getMonth()+1),[n,g]=(0,s.useState)(!1),[j,z]=(0,s.useState)({total_views:0,unique_visitors:0}),[f,p]=(0,s.useState)({total_views:0,unique_visitors:0}),[N,v]=(0,s.useState)([]),[k,w]=(0,s.useState)([]),[y,_]=(0,s.useState)([]),[S,A]=(0,s.useState)([]);return(0,s.useEffect)(()=>{(async function(){let{data:e}=await l.O.rpc("get_analytics_kpis",{date_from:"2000-01-01",date_to:"2099-12-31"});e&&p(e)})()},[]),(0,s.useEffect)(()=>{(async function(){let t,r,s;if(g(!0),0===a)t=`${e}-01-01T00:00:00.000Z`,r=`${e}-12-31T23:59:59.999Z`,s="month";else{let l=new Date(Date.UTC(e,a-1,1)),i=new Date(Date.UTC(e,a,0,23,59,59,999));t=l.toISOString(),r=i.toISOString(),s="day"}let[i,d,n,c,o]=await Promise.all([l.O.rpc("get_analytics_kpis",{date_from:t,date_to:r}),l.O.rpc("get_analytics_trend",{date_from:t,date_to:r,trunc_interval:s}),l.O.rpc("get_analytics_pages",{date_from:t,date_to:r}),l.O.rpc("get_analytics_geo",{date_from:t,date_to:r}),l.O.rpc("get_analytics_referrers",{date_from:t,date_to:r})]);i.data&&z(i.data),d.data&&v(d.data),n.data&&w(n.data),c.data&&_(c.data),o.data&&A(o.data),g(!1)})()},[e,a]),(0,r.jsxs)(i.W2,{className:"mt-16 sm:mt-32",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-8 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-zinc-900 dark:text-zinc-100",children:"Analytics Dashboard"}),(0,r.jsxs)("p",{className:"text-zinc-500",children:["All Time Views: ",(0,r.jsx)("span",{className:"font-bold",children:f.total_views})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("select",{value:a,onChange:e=>d(Number(e.target.value)),className:"rounded-md border-zinc-300 dark:border-zinc-700 dark:bg-zinc-800 text-sm",children:[{value:0,label:"Whole Year"},{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}].map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,r.jsx)("select",{value:e,onChange:e=>t(Number(e.target.value)),className:"rounded-md border-zinc-300 dark:border-zinc-700 dark:bg-zinc-800 text-sm",children:[2024,2025,2026].map(e=>(0,r.jsx)("option",{value:e,children:e},e))}),(0,r.jsx)("button",{onClick:()=>l.O.auth.signOut(),className:"ml-4 text-sm text-red-500 hover:text-red-700",children:"Sign Out"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-zinc-800 p-6 rounded-lg border border-zinc-200 dark:border-zinc-700",children:[(0,r.jsx)("p",{className:"text-zinc-500 text-sm",children:"Period Views"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-zinc-900 dark:text-zinc-100",children:j.total_views})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-zinc-800 p-6 rounded-lg border border-zinc-200 dark:border-zinc-700",children:[(0,r.jsx)("p",{className:"text-zinc-500 text-sm",children:"Unique Visitors"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-zinc-900 dark:text-zinc-100",children:j.unique_visitors})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 bg-white dark:bg-zinc-800 p-6 rounded-lg border border-zinc-200 dark:border-zinc-700",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-4 text-zinc-900 dark:text-zinc-100",children:["Traffic Trend (",0===a?"Monthly":"Daily",")"]}),(0,r.jsx)("div",{className:"h-64 w-full",children:(0,r.jsx)(c.h,{width:"100%",height:"100%",children:(0,r.jsxs)(o.v,{data:N,children:[(0,r.jsx)(x.q,{strokeDasharray:"3 3",vertical:!1,stroke:"#E4E4E7"}),(0,r.jsx)(m.K,{dataKey:"date",tickFormatter:e=>{let t=new Date(e);return 0===a?t.toLocaleDateString("en-US",{month:"short"}):t.getDate()},stroke:"#A1A1AA",fontSize:12}),(0,r.jsx)(h.B,{stroke:"#A1A1AA",fontSize:12}),(0,r.jsx)(b.u,{contentStyle:{backgroundColor:"#18181B",border:"none",borderRadius:"8px",color:"#fff"},labelStyle:{color:"#A1A1AA"}}),(0,r.jsx)(u.$Q,{dataKey:"views",fill:"#14B8A6",radius:[4,4,0,0]})]})})})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-zinc-800 p-6 rounded-lg border border-zinc-200 dark:border-zinc-700",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4 text-zinc-900 dark:text-zinc-100",children:"Top Pages"}),(0,r.jsx)("div",{className:"overflow-auto max-h-96",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-zinc-100 dark:border-zinc-700 text-left text-zinc-500",children:[(0,r.jsx)("th",{className:"pb-2 font-medium",children:"Path"}),(0,r.jsx)("th",{className:"pb-2 font-medium text-right",children:"Views"})]})}),(0,r.jsx)("tbody",{children:k.map(e=>(0,r.jsxs)("tr",{className:"border-b border-zinc-100 dark:border-zinc-700 last:border-0",children:[(0,r.jsx)("td",{className:"py-2 text-zinc-900 dark:text-zinc-300 truncate max-w-[200px]",title:e.path,children:e.path}),(0,r.jsx)("td",{className:"py-2 text-right text-zinc-900 dark:text-zinc-300",children:e.views})]},e.path))})]})})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-zinc-800 p-6 rounded-lg border border-zinc-200 dark:border-zinc-700",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4 text-zinc-900 dark:text-zinc-100",children:"Referrers"}),(0,r.jsx)("div",{className:"overflow-auto max-h-96",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-zinc-100 dark:border-zinc-700 text-left text-zinc-500",children:[(0,r.jsx)("th",{className:"pb-2 font-medium",children:"Source"}),(0,r.jsx)("th",{className:"pb-2 font-medium text-right",children:"Visits"})]})}),(0,r.jsx)("tbody",{children:S.map(e=>(0,r.jsxs)("tr",{className:"border-b border-zinc-100 dark:border-zinc-700 last:border-0",children:[(0,r.jsx)("td",{className:"py-2 text-zinc-900 dark:text-zinc-300",children:e.referrer||"Direct"}),(0,r.jsx)("td",{className:"py-2 text-right text-zinc-900 dark:text-zinc-300",children:e.visits})]},e.referrer))})]})})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-zinc-800 p-6 rounded-lg border border-zinc-200 dark:border-zinc-700 lg:col-span-2",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4 text-zinc-900 dark:text-zinc-100",children:"Geography"}),(0,r.jsx)("div",{className:"overflow-auto max-h-96",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-zinc-100 dark:border-zinc-700 text-left text-zinc-500",children:[(0,r.jsx)("th",{className:"pb-2 font-medium",children:"City"}),(0,r.jsx)("th",{className:"pb-2 font-medium",children:"Country"}),(0,r.jsx)("th",{className:"pb-2 font-medium text-right",children:"Visits"})]})}),(0,r.jsx)("tbody",{children:y.map((e,t)=>{let a="-",s="-";try{let t="string"==typeof e.location?JSON.parse(e.location):e.location;t&&(a=t.city,s=t.country)}catch(e){}return(0,r.jsxs)("tr",{className:"border-b border-zinc-100 dark:border-zinc-700 last:border-0",children:[(0,r.jsx)("td",{className:"py-2 text-zinc-900 dark:text-zinc-300",children:a}),(0,r.jsx)("td",{className:"py-2 text-zinc-900 dark:text-zinc-300",children:s}),(0,r.jsx)("td",{className:"py-2 text-right text-zinc-900 dark:text-zinc-300",children:e.visits})]},t)})})]})})]})]})]})}}},function(e){e.O(0,[796,888,774,179],function(){return e(e.s=2833)}),_N_E=e.O()}]);